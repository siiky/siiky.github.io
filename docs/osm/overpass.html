<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head><meta charset="utf-8"/></head>
<body>

<h1>Overpass</h1>
<p>@siiky
2022/03/26
2022/12/28</p>
<p>Overpass is an interface used to query OSM data. Overpass Turbo is an Overpass web client you can use to query OSM data, export it, &amp;c.</p>
<ul>
<li><a href="https://overpass-turbo.eu">Overpass Turbo</a></li>
<li><a href="https://wiki.openstreetmap.org/wiki/Overpass_turbo">Overpass Turbo (OSM Wiki)</a></li>
<li><a href="https://wiki.openstreetmap.org/wiki/Overpass_API/Overpass_QL">Overpass Query Language</a></li>
<li><a href="https://wiki.openstreetmap.org/wiki/Overpass_API">Overpass API</a></li></ul>
<h2>Useful Queries</h2>
<p>This is a list of useful queries I've learned over time.</p>
<h3>Features last modified by an user</h3>
<p>Nodes, ways, or relations last modified by &quot;user name&quot;:</p>
<pre><code>nwr(user:&quot;user name&quot;)({{bbox}});
out body;
</code></pre>
<h3>Features modified between two dates</h3>
<p>Node, way, or relation amenities modified between 2022-02-04T00:00:00Z and &quot;to-date&quot;:</p>
<pre><code>// to-date is optional and defaults to now
[diff:&quot;2022-02-04T00:00:00Z&quot;,&quot;to-date&quot;];
nwr[&quot;amenity&quot;]({{bbox}});
out body;
</code></pre>
<h3>Features around other features</h3>
<p>Picnic sites within a 1km radius of restaurants with takeaway:</p>
<pre><code>node[amenity=restaurant][takeaway=yes]({{bbox}});
node(around:1000)[tourism=picnic_site];
out body;
</code></pre>
<h3>Features inside some area object</h3>
<p>Libraries in Portugal:</p>
<pre><code>nwr[&quot;amenity&quot;=&quot;library&quot;](area:3600295480);
out body;

// Or:

area(3600295480)-&gt;.searchArea;
(nwr[&quot;amenity&quot;=&quot;library&quot;](area.searchArea););
out body;
&gt;;
out skel qt;
</code></pre>
<p>I don't understand the difference between the two yet, but the latter is supposed to be more correct. All I know is that >; makes the query recursive (whatever that means).</p>
<p>Found on StackOverflow an explanation of the area:XXX:</p>
<blockquote>
<p>If the polygon you want to query inside of is an OSM feature, you can also query using an area ID.</p>
<p>Area IDs are generated by the Overpass server to make querying data within existing polygons easier. You can determine the area ID for a way by adding 2400000000 to the way ID and the area ID for a relation by adding 3600000000 to the relation ID (assuming that the way or relation is a valid area feature).</p></blockquote>
<ul>
<li><a href="https://stackoverflow.com/a/65982945">https://stackoverflow.com/a/65982945</a></li></ul>
<p>I found Portugal's relation object, which is the relation 295480, and 3600000000+295480=3600295480.</p>
<ul>
<li><a href="https://www.openstreetmap.org/relation/295480">https://www.openstreetmap.org/relation/295480</a></li></ul>
<h3>Color-coding OSM data by age</h3>
<p>Based on this diary entry by SK53:</p>
<ul>
<li>
<p><a href="https://www.openstreetmap.org/user/SK53/diary/400570">Colour-coding OSM data by age in OverpassTurbo</a></p>
<p>[out:json][timeout:2500];
(
  nwr<a href="{{bbox}}">&quot;highway&quot;</a>;
  nwr<a href="{{bbox}}">&quot;building&quot;</a>;
);
(._;&gt;;);
out meta;</p>
<p>{{style:</p>
<p>node {
  color: #00000000;
  fill-color: #00000000;
}</p>
<p>way[@timestamp=~/2022.*/] {
  color: #313695;
  fill-color: #313695;
}
way[@timestamp=~/2021.*/] {
  color: #4575B4;
  fill-color: #4575B4;
}
way[@timestamp=~/2020.*/] {
  color: #74ADD1;
  fill-color: #74ADD1;
}
way[@timestamp=~/2019.*/] {
  color: #ABD9E9;
  fill-color: #ABD9E9;
}
way[@timestamp=~/2018.*/] {
  color: #E0F3F8;
  fill-color #E0F3F8;
}
way[@timestamp=~/2017.*/] {
  color: #FFFFBF;
  fill-color: #FFFFBF;
}
way[@timestamp=~/2016.*/] {
  color: #FEE090;
  fill-color: #FEE090;
}
way[@timestamp=~/2015.*/] {
  color: #FDAE61;
  fill-color: #FDAE61;
}
way[@timestamp=~/2014.*/] {
  color: #F46D43;
  fill-color: #F46D43;
}
way[@timestamp=~/2013.*/] {
  color: #D73027;
  fill-color: #D73027;
}
way[@timestamp=~/2012.*/] {
  color: #A50026;
  fill-color: #A50026;
}
way[@timestamp=~/2011.*/] {
  color: #A50026;
  fill-color: #A50026;
}
way[@timestamp=~/2010.*/] {
  color: #A50026;
  fill-color: #A50026;
}
way[@timestamp=~/200.*/] {
  color: #A50026;
  fill-color: #A50026;
}
}}</p></li></ul>
</body>
</html>
