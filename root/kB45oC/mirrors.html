<p>Contacted <a href="https://plato.stanford.edu">SEP</a> yesterday
asking if there was a way to make personal archives/mirrors of either
the whole site or several entries.</p>
<p>They kindly replied (aweome, and thanks!) quoting the <a
href="https://plato.stanford.edu/info.html#terms"><em>Terms of
Use</em></a>¹, saying that I have permission to freely crawl/download
entries for personal use, within reasonable network use (1. <em>User
Rights</em>) – I just can't make them public (non-personal) (2b. &amp;
2d. <em>Limited Electronic Distribution Rights</em>).</p>
<p>While I don't mean to convince them of anything, it gave me the idea
for this post: big sites that publish content publicly for free use are
a great fit for experimenting with novel means of distribution and
archival other than the <del>good</del> bad old HTTP we have today.</p>
<p>More specifically, I'll try to convince you that <em>content-based
content addressing</em> (<a
href="https://en.wikipedia.org/wiki/Content-addressable_network">Wikipedia</a>,
<a
href="https://docs.ipfs.io/concepts/glossary/#content-addressing">IPFS</a>)
is a better alternative to <em>location-based content addressing</em>
(the current web), and try to explain how and why.</p>
<p>To make writing easier, I'll pick the Debian package repos as a sort
of "case study", but other package repositories (Arch, Nix, F-Droid,
Flathub, …) would work equally well. A good alternative would be any
Wikimedia site, such as Wikipedia.² I'll write about mirrors but much of
it applies to archives equally well. Although some of the points I'll
raise may have nuances that make more sense to sites or to package
repos, to archives or to mirrors, the spirit is there!</p>
<h1 id="location-based-addressing">Location-based Addressing</h1>
<p>Let's start with <em>content</em>.</p>
<p>Setting up a mirror site isn't for just about anyone. You can't wake
up one day and think <em>yup, feel like mirroring Debian's repos
starting today.</em> Ignoring technical requirements, there's too much
bureaucracy for you to decide it on such a whim.³ But is this
bureaucracy necessary? I don't think so, I think it's only a symptom of
the current web.</p>
<p>On the current web (<em>location-based</em>), when you go to <code
class="verbatim">https://example.com/some-page.html</code> you don't
know what you're gonna get – hopefully whatever it is you're looking
for, but you just can't know. Plus, the content you get <em>from a
location</em> may change from today to tomorrow – a very important
point.</p>
<p>Imagine if anyone could claim to be a Debian mirror. Users set <code
class="verbatim">example.com/debian-repo</code> in <code
class="verbatim">sources.list</code>, thinking they're getting the
official Debian packages, but (dramatic plot twist) the mirror is
malicious and all the packages play nyan cat in loop.</p>
<p>To emphasize it: there's no way for a site to prove what content it's
serving, or for you to know that you'll get what you're expecting.⁴ When
you visit some page on the current web, you <strong>have</strong> to
trust the site. And because the content delivered from a particular
location may change, the trustworthy sites of today may not be so
tomorrow.</p>
<p>What would the consequences be if a hypothetical Debian mirror
was/became malicious? Assuming it was an official one (i.e., listed on
the <a href="https://www.debian.org/mirror/list">mirrors</a>): Debian
would have to drop it from the list; damage to its users resulting from
it couldn't be undone (or very unlikely); but worst of all, the rules
for registering as a mirror would very likely become stricter in an
effort to avoid another incident, thus making the content more
centralized, and all the <del>good</del> bad that comes with it.</p>
<h1 id="content-based-addressing">Content-based Addressing</h1>
<p>In contrast, in a <em>content-based</em> system, content is uniquely
identified by something⁵, so that when you ask for content <code
class="verbatim">ABC</code> you'll get <code
class="verbatim">ABC</code>, not <code class="verbatim">XYZ</code>. This
has lots of implications!</p>
<p>(<strong>Side note:</strong> a <em>content-based</em> system needn't
necessarily be a public P2P network, but since the post is about
publicly shared &amp; shareable content, it's what makes most sense, and
what I'll use as a model here, with all the <del>bad</del> good that
comes with it.)</p>
<p>First, since the content is no longer tied to a trusted entity (site
owner/operator), the content can be distributed by anyone, and the
system takes care of making sure the content you get corresponds to the
content you request.</p>
<p>With the trust deal sealed, the bureaucracy is no longer necessary.
If Debian's repos were available through such a system, deciding to
mirror them from one day to the next wouldn't be unthinkable! You could
easily opt-in to mirror their repos, and they could trust the system to
deliver users the (authentic) packages they request, independently of
whom they get the packages from.</p>
<p>Since anyone can safely share the content with anyone else more
easily, more people can join in and help share that content. I could
share the packages I have installed on my own PCs, for example, helping
other people download them too.</p>
<p>Bonus benefit: Debian's traffic would decrease, and file transfer
would be more local, that is, you'd generally get the files from your
closest neighbors (that have them, of course), making the whole
packaging system more robust (<a
href="https://en.wikipedia.org/wiki/Resilience_(network)">resilient</a>)
– even if Debian's servers go down, I can install things as long as I
can connect to anyone that has them.</p>
<p>Unfortunately, however, this is only the ideal. For some reason
unbeknownst to me, people prefer to stick with the archaic <a
href="https://en.wikipedia.org/wiki/Client%E2%80%93server_model">C-S
architecture</a> and <em>the so very great HTTP centralized
web</em>.</p>
<p>The only problem I haven't mentioned yet is that we don't want
content to be immutable (one of the implications of content-based
addressing). There <strong>must</strong> be a way to "update" content,
that is, we still need some form of location-based addressing. There are
some ways to do this. One is for the content owner to provide the latest
"root" address through some current means, e.g., <code
class="verbatim">https://debian.org/root-content</code>. Another is to
put a similar mechanism into the system, e.g., entities may publish the
latest "root" address to the network on a known (location-based)
address.</p>
<h1 id="ipfs">IPFS</h1>
<p>Now, I didn't come up with any of these ideas myself. I tried to make
the post a bit generic, but always thinking of a particular network in
the background. And it should be unsurprising that this network should
be IPFS. It's the best content-based addressable P2P content
distribution network that I know of to date.</p>
<p>I won't go into details here, but there's a "namespace" of
content-identifiers (CIDs), and two network schemes: one for
content-based addressing (<code class="verbatim">ipfs://</code>) and
another for location-based addressing (<code
class="verbatim">ipns://</code>).⁶</p>
<p>Unfortunately, IPNS is yet to become generally practical. And, as is
common of P2P content distribuition networks, unpopular content is hard
to get (especially slow to find). Finally, the "reference" IPFS node
implementation, <code class="verbatim">go-ipfs</code>, is a bit more
resource hungry than BitTorrent clients.⁷</p>
<h1 id="footnotes">Footnotes</h1>
<p>¹ I hadn't come across the ToU before while browsing the site
(refreshing!) and even had some trouble finding them after the
email.</p>
<p>² Except there are no "official" Wikipedia mirrors, and no
restrictions or bureaucracies to become one. See <a
href="https://en.wikipedia.org/wiki/Wikipedia:Mirrors_and_forks"><em>Mirrors
and forks</em></a> and <a
href="https://en.wikipedia.org/wiki/Wikipedia:FAQ/Forking"><em>Forking
FAQ</em></a>.</p>
<p>³ Admittedly, much less than I would ever have expected: a manual
request! See <a
href="https://www.debian.org/mirror/ftpmirror"><em>Setting up a Debian
archive mirror</em></a>. But even this little is already too much…</p>
<p>⁴ In the particular case of package repos, a list of checksums, for
example, could be downloaded from the official repos, and used to
confirm individual files haven't been altered (<code>apt</code> uses a
simple "clock" version to detect outdated mirrors but nothing else).
Authenticity of files could be checked using, for example, pubkey
cryptography (<code>apt</code> does this), but still there are caveats –
you know a file came from who you expect, but not that it
<strong>is</strong> the file you want.</p>
<p>⁵ This is a technical implementation detail, but if it makes it
easier to understand you can think of it as a cryptographic hash of the
content. It's only important that the <em>something</em> be determinisc
and based on the content itself.</p>
<p>⁶ The CID "namespace" is shared, so the same CID may identify
different content, depending on the scheme (as expected).</p>
<p>⁷ While you may be able to run a BT client on a phone, for example, a
full IPFS node would likely be inefficient/slow – a Raspberry Pi 2 can
still manage it for light use. Version <a
href="https://github.com/ipfs/go-ipfs/releases/tag/v0.13.0#support-for-block-and-car-response-formats">v0.13.0</a>
introduced some changes that make "light nodes" closer to a possibility,
but no such (working) node exists as of now, AFAIK.</p>
